<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get stop times patterns — get_stop_times_patterns • gtfstools</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get stop times patterns — get_stop_times_patterns"><meta name="description" content='Identifies spatial and spatiotemporal patterns within the stop_times
table. Please see the details to understand what a "pattern" means in each of
these cases.'><meta property="og:description" content='Identifies spatial and spatiotemporal patterns within the stop_times
table. Please see the details to understand what a "pattern" means in each of
these cases.'><meta property="og:image" content="https://ipeagit.github.io/gtfstools/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gtfstools</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/gtfstools.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/filtering.html">Filtering GTFS feeds</a></li>
    <li><a class="dropdown-item" href="../articles/validating.html">Validating GTFS feeds</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ipeaGIT/gtfstools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get stop times patterns</h1>
      <small class="dont-index">Source: <a href="https://github.com/ipeaGIT/gtfstools/blob/main/R/get_stop_times_patterns.R" class="external-link"><code>R/get_stop_times_patterns.R</code></a></small>
      <div class="d-none name"><code>get_stop_times_patterns.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Identifies spatial and spatiotemporal patterns within the <code>stop_times</code>
table. Please see the details to understand what a "pattern" means in each of
these cases.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_stop_times_patterns</span><span class="op">(</span></span>
<span>  <span class="va">gtfs</span>,</span>
<span>  trip_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"spatial"</span>,</span>
<span>  sort_sequence <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-gtfs">gtfs<a class="anchor" aria-label="anchor" href="#arg-gtfs"></a></dt>
<dd><p>A GTFS object, as created by <code><a href="read_gtfs.html">read_gtfs()</a></code>.</p></dd>


<dt id="arg-trip-id">trip_id<a class="anchor" aria-label="anchor" href="#arg-trip-id"></a></dt>
<dd><p>A character vector including the <code>trip_id</code>s to have their
<code>stop_times</code> entries analyzed. If <code>NULL</code> (the default), the function
analyses the pattern of every <code>trip_id</code> in the GTFS.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>A string specifying the type of patterns to be analyzed. Either
<code>"spatial"</code> (the default) or "spatiotemporal".</p></dd>


<dt id="arg-sort-sequence">sort_sequence<a class="anchor" aria-label="anchor" href="#arg-sort-sequence"></a></dt>
<dd><p>A logical specifying whether to sort timetables by
<code>stop_sequence</code>. Defaults to <code>FALSE</code>, otherwise spec-compliant feeds, in
which timetables points are already ordered by <code>stop_sequence</code>, would be
penalized through longer processing times. Pattern identification based on
unordered timetables may result in multiple ids identifying what would be
the same pattern, had the table been ordered.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.table</code> associating each <code>trip_id</code> to a <code>pattern_id</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p>Two trips are assigned to the same spatial <code>pattern_id</code> if they travel along
the same sequence of stops. They are assigned to the same spatiotemporal
<code>pattern_id</code>, on the other hand, if they travel along the same sequence of
stops and they take the same time between stops. Please note that, in such
case, only the time between stops is taken into account, and the time that
the trip started is ignored (e.g. if two trips depart from stop A and follow
the same sequence of stops to arrive at stop B, taking both 1 hour to do so,
their spatiotemporal pattern will be considered the same, even if one
departed at 6 am and another at 7 am). Please also note that the
<code>stop_sequence</code> field is currently ignored - which means that two stops are
considered to follow the same sequence if one is listed right below the
other on the <code>stop_times</code> table (e.g. if trip X lists stops A followed by
stop B with <code>stop_sequence</code>s 1 and 2, and trip Y lists stops A followed by
stop B with <code>stop_sequence</code>s 1 and 3, they are assigned to the same
<code>pattern_id</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/ber_gtfs.zip"</span>, package <span class="op">=</span> <span class="st">"gtfstools"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gtfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_gtfs.html">read_gtfs</a></span><span class="op">(</span><span class="va">data_path</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">patterns</span> <span class="op">&lt;-</span> <span class="fu">get_stop_times_patterns</span><span class="op">(</span><span class="va">gtfs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">patterns</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;trip_id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      trip_id pattern_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;char&gt;      &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: 143765655          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2: 143765656          2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3: 143765658          3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4: 143765659          3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5: 143765660          3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6: 143765661          3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use the trip_id argument to control which trips are analyzed</span></span></span>
<span class="r-in"><span><span class="va">patterns</span> <span class="op">&lt;-</span> <span class="fu">get_stop_times_patterns</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">gtfs</span>,</span></span>
<span class="r-in"><span>  trip_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"143765658"</span>, <span class="st">"143765659"</span>, <span class="st">"143765660"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">patterns</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;trip_id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      trip_id pattern_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;char&gt;      &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: 143765658          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2: 143765659          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3: 143765660          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use the type argument to control the type of pattern analyzed</span></span></span>
<span class="r-in"><span><span class="va">patterns</span> <span class="op">&lt;-</span> <span class="fu">get_stop_times_patterns</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">gtfs</span>,</span></span>
<span class="r-in"><span>  trip_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"143765658"</span>, <span class="st">"143765659"</span>, <span class="st">"143765660"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"spatiotemporal"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">patterns</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;trip_id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      trip_id pattern_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;char&gt;      &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: 143765658          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2: 143765659          2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3: 143765660          2</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Herszenhut, Rafael H. M. Pereira, Pedro R. Andrade, Joao Bazzo, Ipea - Institute for Applied Economic Research.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

